import{j as e,X as E,a as c,r as T,f as v,H as P}from"./app-BuFDx-Qe.js";import{B as g}from"./button-BZVWAlVI.js";import{C as k,a as y}from"./card-CqwUC94o.js";import{D as U,x as $,y as I,z as M,w as D,A,B as L}from"./app-layout-gv3U0F6q.js";import{I as N}from"./input-ElP9p0lG.js";import{C as H}from"./chevron-down-DtgeBsEm.js";import{H as R}from"./heading-B2fIiO5y.js";import{P as z}from"./pagination-CfkSe50y.js";import{T as B}from"./transactions-table-B63XHdDG.js";import{P as F}from"./plus-DpSOfxOS.js";/* empty css            */import"./index-DR5cvZQc.js";import"./index-CGZUerCI.js";import"./app-logo-icon-DNGdMlik.js";import"./table-CyNWMn4z.js";function O({filters:l,isLoading:d,selectedUserIds:t,selectedUsersText:u,hasActiveFilters:x,getFilterSummary:f,handlePresetClick:i,handleDateChange:m,handleUserToggle:h,handleClearFilters:p,PRESETS:_,users:n}){return e.jsx(k,{children:e.jsx(y,{className:"p-4",children:e.jsxs("div",{className:"flex flex-col gap-4",children:[e.jsx("div",{className:"flex flex-wrap gap-2",children:_.map(r=>e.jsx(g,{variant:l.preset===r.value?"default":"outline",size:"sm",onClick:()=>i(r.value),disabled:d,children:r.label},r.value))}),e.jsxs("div",{className:"flex flex-wrap gap-4",children:[e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsx("label",{htmlFor:"from_date",className:"text-sm font-medium",children:"From Date"}),e.jsx(N,{id:"from_date",type:"date",value:l.from_date||"",onChange:r=>m("from_date",r.target.value),disabled:d||l.preset!==null})]}),e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsx("label",{htmlFor:"to_date",className:"text-sm font-medium",children:"To Date"}),e.jsx(N,{id:"to_date",type:"date",value:l.to_date||"",onChange:r=>m("to_date",r.target.value),disabled:d||l.preset!==null})]}),n.length>0&&e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsx("label",{className:"text-sm font-medium",children:"Users"}),e.jsxs(U,{children:[e.jsx($,{asChild:!0,children:e.jsxs(g,{variant:"outline",className:"w-full justify-between",disabled:d,children:[e.jsx("span",{children:u}),e.jsx(H,{className:"h-4 w-4 opacity-50"})]})}),e.jsx(I,{className:"w-56",children:n.map(r=>e.jsx(M,{checked:t.includes(r.id),onCheckedChange:()=>h(r.id),children:r.name},r.id))})]})]}),x&&e.jsx("div",{className:"flex items-end",children:e.jsxs(g,{variant:"outline",size:"sm",onClick:p,disabled:d,children:[e.jsx(E,{className:"mr-1 h-4 w-4"}),"Clear Filters"]})})]}),e.jsx("div",{className:"text-sm text-muted-foreground",children:d?"Loading...":f()})]})})})}const S=[{value:"last_30_days",label:"Last 30 Days"},{value:"this_month",label:"This Month"},{value:"last_month",label:"Last Month"},{value:"last_week",label:"Last Week"}];function Y({initialFilters:l={},users:d=[]}={}){const[t,u]=c.useState({user_id:l.user_id??null,user_ids:l.user_ids??[],from_date:l.from_date??null,to_date:l.to_date??null,preset:l.preset??null}),[x,f]=c.useState(!1);c.useEffect(()=>{u({user_id:l.user_id??null,user_ids:l.user_ids??[],from_date:l.from_date??null,to_date:l.to_date??null,preset:l.preset??null})},[l]);const i=c.useCallback(s=>{f(!0);const a=new URLSearchParams;s.user_ids&&s.user_ids.length>0?s.user_ids.forEach(o=>{a.append("user_ids[]",o.toString())}):s.user_id&&a.set("user_id",s.user_id.toString()),s.from_date&&a.set("from_date",s.from_date),s.to_date&&a.set("to_date",s.to_date),s.preset&&a.set("preset",s.preset),T.get(D().url+(a.toString()?`?${a.toString()}`:""),{},{preserveState:!0,preserveScroll:!0,onFinish:()=>f(!1)})},[]),m=c.useCallback(s=>{const a={...t,preset:s,from_date:null,to_date:null};u(a),i(a)},[t,i]),h=c.useCallback((s,a)=>{const o={...t,[s]:a||null,preset:null};u(o),i(o)},[t,i]),p=c.useCallback(s=>{const a=t.user_ids||[],o=a.includes(s)?a.filter(w=>w!==s):[...a,s],j={...t,user_ids:o,user_id:null};u(j),i(j)},[t,i]),_=c.useCallback(()=>{const s={user_id:null,user_ids:[],from_date:null,to_date:null,preset:null};u(s),i(s)},[i]),n=c.useMemo(()=>t.user_ids||[],[t.user_ids]),r=n.length===0?"All Users":n.length===1?d.find(s=>s.id===n[0])?.name||"1 user":`${n.length} users`,C=t.user_ids&&t.user_ids.length>0||t.user_id!==null||t.from_date!==null||t.to_date!==null||t.preset!==null,b=c.useCallback(()=>{const s=[];if(n.length>0)if(n.length===1){const a=d.find(o=>o.id===n[0])?.name||"selected user";s.push(`for ${a}`)}else s.push(`for ${n.length} users`);if(t.preset){const a=S.find(o=>o.value===t.preset)?.label||"";s.push(`for ${a}`)}else if(t.from_date||t.to_date){const a=t.from_date?v(t.from_date):"beginning",o=t.to_date?v(t.to_date):"today";s.push(`from ${a} to ${o}`)}else{const a=new Date,o=new Date(a.getFullYear(),a.getMonth(),1),j=new Date(a.getFullYear(),a.getMonth()+1,0);s.push(`from ${v(o.toISOString().split("T")[0])} to ${v(j.toISOString().split("T")[0])}`)}return`Showing expenses ${s.join(" ")}`},[t,n,d]);return{filters:t,isLoading:x,selectedUserIds:n,selectedUsersText:r,hasActiveFilters:C,getFilterSummary:b,handlePresetClick:m,handleDateChange:h,handleUserToggle:p,handleClearFilters:_,PRESETS:S}}const W=[{title:"Transactions",href:D().url}];function oe({transactions:l,filters:d={},users:t=[]}){const{filters:u,isLoading:x,selectedUserIds:f,selectedUsersText:i,hasActiveFilters:m,getFilterSummary:h,handlePresetClick:p,handleDateChange:_,handleUserToggle:n,handleClearFilters:r,PRESETS:C}=Y({initialFilters:d,users:t}),b=()=>{T.visit(L().url)};return e.jsxs(A,{breadcrumbs:W,children:[e.jsx(P,{title:"Transactions"}),e.jsxs("div",{className:"flex h-full flex-1 flex-col gap-4 overflow-x-auto rounded-xl p-4",children:[e.jsx(R,{title:"Transactions",description:"All my transactions transactions"}),e.jsx("div",{className:"flex w-full justify-end",children:e.jsxs(g,{onClick:b,children:[e.jsx(F,{}),"Add Expense"]})}),e.jsx(O,{filters:u,isLoading:x,selectedUserIds:f,selectedUsersText:i,hasActiveFilters:m,getFilterSummary:h,handlePresetClick:p,handleDateChange:_,handleUserToggle:n,handleClearFilters:r,PRESETS:C,users:t}),e.jsx("div",{className:"flex flex-col gap-4",children:l.data.length===0?e.jsx(k,{children:e.jsxs(y,{className:"p-8 text-center",children:[e.jsx("p",{className:"text-muted-foreground",children:"No expenses found for the selected filters."}),m&&e.jsx(g,{variant:"outline",className:"mt-4",onClick:r,children:"Clear Filters"})]})}):e.jsxs(e.Fragment,{children:[e.jsx(B,{transactions:l,type:"expense"}),e.jsx(z,{paginatedData:l})]})})]})]})}export{oe as default};

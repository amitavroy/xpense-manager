import{a as g,j as e,R as x,d as W,c as z,u as Y,H as Z,f as N}from"./app-ve5BU_pJ.js";import{H as ee}from"./heading-CurFds9m.js";import{B as E}from"./button-D2x7kvve.js";import{C as P,b as S,c as y,a as F}from"./card-Clb8znuj.js";import{u as A,P as k,c as se,b as te}from"./index-CQI2C884.js";import{ad as ae,ae as H,f as re,af as oe,ag as ie,ah as ne,A as le,X as de}from"./app-layout-B16zKjzA.js";import{C as M}from"./checkbox-9GFXk7aE.js";import{D as ce,a as ue,b as pe,c as xe,d as he,f as ge}from"./dialog-B5xdTuwH.js";import{F as me,a as fe,b as j,c as _,d as b,e as C}from"./field-F1f4fuUp.js";import{I as D}from"./input-DjXr1uaT.js";import{T as ve}from"./trip-form-CrA2cOWh.js";import{E as je}from"./expenses-table-BqX2CoCA.js";import{P as be}from"./plus-BMEEb-Ab.js";/* empty css            */import"./index-CGZUerCI.js";import"./app-logo-icon-B4GUqTPf.js";import"./index-KgTj-bHc.js";import"./label-BGxtZQUH.js";import"./confirm-dialog-Bbk_xA_X.js";import"./table-DyIf9P2r.js";var $="Toggle",B=g.forwardRef((s,t)=>{const{pressed:o,defaultPressed:l,onPressedChange:n,...r}=s,[d,a]=A({prop:o,onChange:n,defaultProp:l??!1,caller:$});return e.jsx(k.button,{type:"button","aria-pressed":d,"data-state":d?"on":"off","data-disabled":s.disabled?"":void 0,...r,ref:t,onClick:se(s.onClick,()=>{s.disabled||a(!d)})})});B.displayName=$;var m="ToggleGroup",[U]=te(m,[H]),O=H(),R=x.forwardRef((s,t)=>{const{type:o,...l}=s;if(o==="single"){const n=l;return e.jsx(Ce,{...n,ref:t})}if(o==="multiple"){const n=l;return e.jsx(Ee,{...n,ref:t})}throw new Error(`Missing prop \`type\` expected on \`${m}\``)});R.displayName=m;var[L,X]=U(m),Ce=x.forwardRef((s,t)=>{const{value:o,defaultValue:l,onValueChange:n=()=>{},...r}=s,[d,a]=A({prop:o,defaultProp:l??"",onChange:n,caller:m});return e.jsx(L,{scope:s.__scopeToggleGroup,type:"single",value:x.useMemo(()=>d?[d]:[],[d]),onItemActivate:a,onItemDeactivate:x.useCallback(()=>a(""),[a]),children:e.jsx(q,{...r,ref:t})})}),Ee=x.forwardRef((s,t)=>{const{value:o,defaultValue:l,onValueChange:n=()=>{},...r}=s,[d,a]=A({prop:o,defaultProp:l??[],onChange:n,caller:m}),u=x.useCallback(p=>a((c=[])=>[...c,p]),[a]),f=x.useCallback(p=>a((c=[])=>c.filter(h=>h!==p)),[a]);return e.jsx(L,{scope:s.__scopeToggleGroup,type:"multiple",value:d,onItemActivate:u,onItemDeactivate:f,children:e.jsx(q,{...r,ref:t})})});R.displayName=m;var[_e,Te]=U(m),q=x.forwardRef((s,t)=>{const{__scopeToggleGroup:o,disabled:l=!1,rovingFocus:n=!0,orientation:r,dir:d,loop:a=!0,...u}=s,f=O(o),p=re(d),c={role:"group",dir:p,...u};return e.jsx(_e,{scope:o,rovingFocus:n,disabled:l,children:n?e.jsx(oe,{asChild:!0,...f,orientation:r,dir:p,loop:a,children:e.jsx(k.div,{...c,ref:t})}):e.jsx(k.div,{...c,ref:t})})}),T="ToggleGroupItem",J=x.forwardRef((s,t)=>{const o=X(T,s.__scopeToggleGroup),l=Te(T,s.__scopeToggleGroup),n=O(s.__scopeToggleGroup),r=o.value.includes(s.value),d=l.disabled||s.disabled,a={...s,pressed:r,disabled:d},u=x.useRef(null);return l.rovingFocus?e.jsx(ae,{asChild:!0,...n,focusable:!d,active:r,ref:u,children:e.jsx(V,{...a,ref:t})}):e.jsx(V,{...a,ref:t})});J.displayName=T;var V=x.forwardRef((s,t)=>{const{__scopeToggleGroup:o,value:l,...n}=s,r=X(T,o),d={role:"radio","aria-checked":s.pressed,"aria-pressed":void 0},a=r.type==="single"?d:void 0;return e.jsx(B,{...a,...n,ref:t,onPressedChange:u=>{u?r.onItemActivate(l):r.onItemDeactivate(l)}})}),Ge=R,we=J;const Ne=W("inline-flex items-center justify-center gap-2 rounded-md text-sm font-medium hover:bg-muted hover:text-muted-foreground disabled:pointer-events-none disabled:opacity-50 data-[state=on]:bg-accent data-[state=on]:text-accent-foreground [&_svg]:pointer-events-none [&_svg:not([class*='size-'])]:size-4 [&_svg]:shrink-0 focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] outline-none transition-[color,box-shadow] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive",{variants:{variant:{default:"bg-transparent",outline:"border border-input bg-transparent shadow-xs hover:bg-accent hover:text-accent-foreground"},size:{default:"h-9 px-2 min-w-9",sm:"h-8 px-1.5 min-w-8",lg:"h-10 px-2.5 min-w-10"}},defaultVariants:{variant:"default",size:"default"}}),K=g.createContext({size:"default",variant:"default"});function Pe({className:s,variant:t,size:o,children:l,...n}){return e.jsx(Ge,{"data-slot":"toggle-group","data-variant":t,"data-size":o,className:z("group/toggle-group flex items-center rounded-md data-[variant=outline]:shadow-xs",s),...n,children:e.jsx(K.Provider,{value:{variant:t,size:o},children:l})})}function I({className:s,children:t,variant:o,size:l,...n}){const r=g.useContext(K);return e.jsx(we,{"data-slot":"toggle-group-item","data-variant":r.variant||o,"data-size":r.size||l,className:z(Ne({variant:r.variant||o,size:r.size||l}),"min-w-0 shrink-0 rounded-none shadow-none first:rounded-l-md last:rounded-r-md focus:z-10 focus-visible:z-10 data-[variant=outline]:border-l-0 data-[variant=outline]:first:border-l",s),...n,children:t})}function Se({trip:s,expense:t,tripMembers:o,open:l,onOpenChange:n}){const r=t?.id!==void 0,{data:d,setData:a,post:u,put:f,processing:p,errors:c,reset:h}=Y({trip_id:s.id,date:t?.date?new Date(t.date).toISOString().split("T")[0]:"",amount:t?.amount||"",description:t?.description||"",is_shared:t?.is_shared??!0,shared_with:t?.shared_with?.map(i=>i.id)||[]});g.useEffect(()=>{t?a({trip_id:s.id,date:t.date?new Date(t.date).toISOString().split("T")[0]:"",amount:t.amount||"",description:t.description||"",is_shared:t.is_shared??!0,shared_with:t.shared_with?.map(i=>i.id)||[]}):(h(),a("trip_id",s.id))},[t,s.id,a,h]);const G=i=>{i.preventDefault();const v=r?ie({trip:s.id,tripExpense:t.id}).url:ne({trip:s.id}).url;r?f(v,{onSuccess:()=>{h(),n(!1)}}):u(v,{onSuccess:()=>{h(),n(!1)}})},w=i=>{const v=d.shared_with;v.includes(i)?a("shared_with",v.filter(Q=>Q!==i)):a("shared_with",[...v,i])};return e.jsx(ce,{open:l,onOpenChange:n,children:e.jsxs(ue,{className:"max-w-2xl",children:[e.jsxs(pe,{children:[e.jsx(xe,{children:r?"Edit Expense":"Add Expense"}),e.jsx(he,{children:r?"Update the expense details":"Add a new expense to this trip"})]}),e.jsxs("form",{onSubmit:G,children:[e.jsx(me,{children:e.jsxs(fe,{children:[e.jsxs(j,{children:[e.jsx(_,{htmlFor:"date",children:"Date"}),e.jsxs(b,{children:[e.jsx(D,{id:"date",type:"date",value:d.date,onChange:i=>a("date",i.target.value)}),e.jsx(C,{errors:c.date?[{message:c.date}]:void 0})]})]}),e.jsxs(j,{children:[e.jsx(_,{htmlFor:"amount",children:"Amount"}),e.jsxs(b,{children:[e.jsx(D,{id:"amount",type:"number",step:"0.01",min:"0.01",value:d.amount,onChange:i=>a("amount",i.target.value),placeholder:"Enter amount"}),e.jsx(C,{errors:c.amount?[{message:c.amount}]:void 0})]})]}),e.jsxs(j,{children:[e.jsx(_,{htmlFor:"description",children:"Description"}),e.jsxs(b,{children:[e.jsx(D,{id:"description",type:"text",value:d.description,onChange:i=>a("description",i.target.value),placeholder:"Enter description"}),e.jsx(C,{errors:c.description?[{message:c.description}]:void 0})]})]}),e.jsx(j,{children:e.jsxs(b,{children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(M,{id:"is_shared",checked:d.is_shared,onCheckedChange:i=>a("is_shared",i===!0)}),e.jsx("label",{htmlFor:"is_shared",className:"cursor-pointer",children:"Share this expense"})]}),e.jsx(C,{errors:c.is_shared?[{message:c.is_shared}]:void 0})]})}),d.is_shared&&o.length>0&&e.jsxs(j,{children:[e.jsx(_,{children:"Share with"}),e.jsxs(b,{children:[e.jsx("div",{className:"flex flex-col gap-2",children:o.map(i=>e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(M,{id:`member-${i.id}`,checked:d.shared_with.includes(i.id),onCheckedChange:()=>w(i.id)}),e.jsx("label",{htmlFor:`member-${i.id}`,className:"cursor-pointer",children:i.name})]},i.id))}),e.jsx(C,{errors:c.shared_with?[{message:c.shared_with}]:void 0})]})]})]})}),e.jsxs(ge,{children:[e.jsx(E,{type:"button",variant:"outline",onClick:()=>n(!1),children:"Cancel"}),e.jsx(E,{type:"submit",disabled:p,children:p?"Saving...":r?"Update Expense":"Add Expense"})]})]})]})})}const ye=[{title:"Trips",href:de().url},{title:"Trip Details",href:"#"}];function We({trip:s,expenses:t,stats:o,tripMembers:l}){const[n,r]=g.useState(!1),[d,a]=g.useState(),[u,f]=g.useState("all"),[p,c]=g.useState(!1),h=()=>{a(void 0),r(!0)},G=i=>{a(i),r(!0)},w=()=>{r(!1),a(void 0)};return e.jsxs(le,{breadcrumbs:ye,children:[e.jsx(Z,{title:"Trip Details"}),e.jsxs("div",{className:"flex h-full flex-1 flex-col gap-4 overflow-x-auto rounded-xl p-4",children:[e.jsx(ee,{title:s.name,description:"Trip expense details"}),p?e.jsx("div",{className:"w-full lg:grid lg:grid-cols-4",children:e.jsx("div",{className:"lg:col-span-2",children:e.jsxs("div",{className:"flex flex-col gap-4",children:[e.jsx(ve,{trip:s,users:l}),e.jsx(E,{variant:"outline",onClick:()=>c(!1),children:"Cancel"})]})})}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"grid gap-4 md:grid-cols-3",children:[e.jsxs(P,{children:[e.jsx(S,{children:e.jsx(y,{className:"text-sm font-medium",children:"Total Expenses by Me"})}),e.jsx(F,{children:e.jsx("div",{className:"text-2xl font-bold",children:N(o.totalExpensesByUser)})})]}),e.jsxs(P,{children:[e.jsx(S,{children:e.jsx(y,{className:"text-sm font-medium",children:"Shared Expenses"})}),e.jsx(F,{children:e.jsx("div",{className:"text-2xl font-bold",children:N(o.totalSharedExpenses)})})]}),e.jsxs(P,{children:[e.jsx(S,{children:e.jsx(y,{className:"text-sm font-medium",children:"Non-Shared Expenses"})}),e.jsx(F,{children:e.jsx("div",{className:"text-2xl font-bold",children:N(o.totalNonSharedExpenses)})})]})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("div",{className:"flex gap-2",children:e.jsxs(Pe,{type:"single",value:u,onValueChange:i=>f(i||"all"),children:[e.jsx(I,{value:"all",children:"All Expenses"}),e.jsx(I,{value:"my",children:"My Expenses"}),e.jsx(I,{value:"shared",children:"Shared Expenses"})]})}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(E,{variant:"outline",onClick:()=>c(!0),children:"Edit Trip"}),e.jsxs(E,{onClick:h,children:[e.jsx(be,{}),"Add Expense"]})]})]}),e.jsx(je,{trip:s,expenses:t,filter:u,onEdit:G})]}),e.jsx(Se,{trip:s,expense:d,tripMembers:l,open:n,onOpenChange:w})]})]})}export{We as default};
